<div class="max-w-5xl mx-auto px-4 py-8" *ngIf="(vm$ | async) as vm">
  <h1 class="text-2xl font-semibold mb-6">Your cart</h1>

  <!-- Empty cart -->
  <div *ngIf="!vm.items.length" class="text-gray-500">Cart is empty.</div>

  <!-- Cart list -->
  <div *ngIf="vm.items.length" class="space-y-4">
    <div *ngFor="let it of vm.items" 
         class="grid grid-cols-12 items-center border rounded-lg p-4 gap-4">

      <!-- Image -->
      <div class="col-span-2 flex justify-center">
        <img [src]="info(it.id)?.images?.thumb || ''"
             alt="{{ info(it.id)?.title }}"
             class="w-16 h-16 object-cover rounded" />
      </div>

      <!-- Title & Artist -->
      <div class="col-span-4">
        <div class="font-medium">{{ info(it.id)?.title }}</div>
        <div class="text-sm text-gray-500">{{ info(it.id)?.artist }}</div>
      </div>

      <!-- Quantity & Remove -->
      <div class="col-span-3 flex items-center gap-3">
        <input type="number"
               min="1"
               class="w-16 border rounded px-2 py-1 text-center"
               [ngModel]="it.qty"
               (ngModelChange)="cart.setQty(it.id, +$event)" />
        <button class="text-sm text-red-500 hover:underline"
                (click)="cart.remove(it.id)">Remove</button>
      </div>

      <!-- Price -->
      <div class="col-span-3 text-right font-semibold">
        {{ (info(it.id)?.price || 0) * it.qty | currency: info(it.id)?.currency }}
      </div>
    </div>

    <!-- Total -->
    <div class="flex justify-end text-xl font-bold mt-6">
    Total: {{ total(vm.items) | currency: (vm.items.length ? info(vm.items[0].id)?.currency : 'CAD') }}
    </div>


    <!-- Checkout -->
    <div class="flex justify-end mt-4">
      <a routerLink="/checkout"
         class="px-5 py-2 bg-black text-white rounded hover:bg-gray-800 transition">
        Email checkout
      </a>
    </div>
  </div>
</div>
